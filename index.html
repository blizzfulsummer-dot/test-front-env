<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fetch Test</title>
<style>
  body { font-family: sans-serif; padding: 2rem; }
  input { padding: 0.5rem; width: 200px; margin-right: 1rem; }
  button { padding: 0.5rem 1rem; }
  #toast {
    visibility: hidden;
    min-width: 200px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 5px;
    padding: 0.5rem;
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1;
  }
  #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2s; }
  @keyframes fadein { from {bottom:0; opacity:0;} to {bottom:30px; opacity:1;} }
  @keyframes fadeout { from {bottom:30px; opacity:1;} to {bottom:0; opacity:0;} }
</style>
</head>
<body>

<h2>Fetch Test</h2>
<input type="text" id="ipField" placeholder="Enter device IP (https://...)">
<button id="fetchBtn">Fetch /api/switch</button>

<div id="toast"></div>

<script>
const ipField = document.getElementById('ipField');
const fetchBtn = document.getElementById('fetchBtn');
const toast = document.getElementById('toast');

function showToast(msg) {
  toast.textContent = msg;
  toast.className = 'show';
  setTimeout(() => toast.className = toast.className.replace('show', ''), 2500);
}

fetchBtn.addEventListener('click', () => {
  const ip = ipField.value.trim();
  if (!ip) return showToast('Please enter a valid IP or URL');

  const url = ip + '/api/switch';

  fetch(url)
    .then(response => {
      if (!response.ok) throw new Error('Network response not ok');
      return response.json();
    })
    .then(data => {
      console.log('Fetch successful:', data);
      showToast('Fetch successful!');
    })
    .catch(err => {
      console.error('Fetch error:', err);
      showToast('Fetch failed. Check console.');
    });
});
</script>

</body>
</html>
