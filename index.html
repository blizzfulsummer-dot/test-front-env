<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ESP Demo Test</title>
</head>
<body>
<h1>ESP Demo Test</h1>

<label for="ip">Enter ESP/Laptop IP:</label>
<input type="text" id="ip" placeholder="192.168.x.x">
<br><br>

<button onclick="fetchSwitches()">Get Switches</button>
<button onclick="fetchSensors()">Get Sensors</button>

<pre id="output"></pre>

<script>
function getBaseUrl() {
  const ip = document.getElementById("ip").value.trim();
  if (!ip) {
    alert("Please enter IP address first!");
    throw new Error("IP not provided");
  }
  return `https://${ip}:4443`;
}

async function fetchSwitches() {
  try {
    const baseUrl = getBaseUrl();
    const res = await fetch(`${baseUrl}/api/switch`);
    const data = await res.json();
    document.getElementById("output").textContent = JSON.stringify(data, null, 2);
  } catch (e) {
    document.getElementById("output").textContent = "Error: " + e;
  }
}

async function fetchSensors() {
  try {
    const baseUrl = getBaseUrl();
    const res = await fetch(`${baseUrl}/api/sensor`);
    const data = await res.json();
    document.getElementById("output").textContent = JSON.stringify(data, null, 2);
  } catch (e) {
    document.getElementById("output").textContent = "Error: " + e;
  }
}
</script>
</body>
</html>
